<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PharmaManager - Tableau de bord</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .material-icons { font-family: 'Material Icons'; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Sidebar (simulée pour contexte) -->
    <div class="fixed left-0 top-0 w-64 h-full bg-white border-r border-gray-200 z-10">
        <div class="p-6 border-b border-gray-200">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-blue-50 rounded-lg flex items-center justify-center">
                    <span class="material-icons text-blue-600">medication</span>
                </div>
                <h2 class="text-lg font-semibold text-gray-900">PharmaManager</h2>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="ml-64 p-6">
        <!-- ÉTAPE 1: HEADER AMÉLIORÉ -->
        <header class="mb-8">
            <!-- Ligne supérieure: Titre + Période active -->
            <div class="flex items-center justify-between mb-6">
                <div>
                    <h1 class="text-3xl font-semibold text-gray-900 mb-2">Tableau de bord</h1>
                    <div class="flex items-center gap-2 text-sm text-gray-600">
                        <span class="material-icons text-base">calendar_today</span>
                        <span>Période: <strong>Janvier 2026</strong></span>
                        <span class="px-2 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium">Actuelle</span>
                    </div>
                </div>
                
                <!-- Actions rapides -->
                <div class="flex items-center gap-3">
                    <button class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2">
                        <span class="material-icons text-base">download</span>
                        Exporter
                    </button>
                    <button class="px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2">
                        <span class="material-icons text-base">add</span>
                        Nouvelle facture
                    </button>
                </div>
            </div>

            <!-- ÉTAPE 1: FILTRES AMÉLIORÉS -->
            <div class="bg-white rounded-xl border border-gray-200 p-6">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-lg font-medium text-gray-900">Filtres</h2>
                    <button id="resetFilters" class="text-sm text-gray-500 hover:text-gray-700 transition-colors hidden">
                        <span class="material-icons text-base align-middle mr-1">refresh</span>
                        Réinitialiser
                    </button>
                </div>
                
                <div class="grid grid-cols-4 gap-4">
                    <!-- Sélecteur de période rapide -->
                    <div class="col-span-1">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Période</label>
                        <select id="periodQuickSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                            <option value="current">Ce mois</option>
                            <option value="last">Mois dernier</option>
                            <option value="quarter">Ce trimestre</option>
                            <option value="year">Cette année</option>
                            <option value="custom">Personnalisé</option>
                        </select>
                    </div>
                    
                    <!-- Mois (pré-rempli) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mois</label>
                        <select id="monthSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                            <option value="">Tous les mois</option>
                            <option value="01" selected>Janvier</option>
                            <option value="02">Février</option>
                            <option value="03">Mars</option>
                            <option value="04">Avril</option>
                            <option value="05">Mai</option>
                            <option value="06">Juin</option>
                            <option value="07">Juillet</option>
                            <option value="08">Août</option>
                            <option value="09">Septembre</option>
                            <option value="10">Octobre</option>
                            <option value="11">Novembre</option>
                            <option value="12">Décembre</option>
                        </select>
                    </div>
                    
                    <!-- Année (pré-remplie) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Année</label>
                        <select id="yearSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                            <option value="">Toutes les années</option>
                            <option value="2026" selected>2026</option>
                            <option value="2025">2025</option>
                            <option value="2024">2024</option>
                            <option value="2023">2023</option>
                        </select>
                    </div>
                    
                    <!-- Statut (nouveau filtre utile) -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Statut</label>
                        <select id="statusSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors">
                            <option value="">Tous les statuts</option>
                            <option value="paid">Payées</option>
                            <option value="pending">En attente</option>
                            <option value="overdue">En retard</option>
                        </select>
                    </div>
                </div>
                
                <!-- Filtres actifs (tags) -->
                <div id="activeFilters" class="mt-4 flex items-center gap-2 hidden">
                    <span class="text-sm text-gray-600">Filtres actifs:</span>
                    <div class="flex gap-2">
                        <!-- Tags dynamiques insérés ici -->
                    </div>
                </div>
            </div>
        </header>

        <!-- KPI Cards (pour contexte visuel) -->
        <div class="grid grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow">
                <div class="flex items-start justify-between mb-3">
                    <div>
                        <p class="text-2xl font-semibold text-gray-900">24</p>
                        <p class="text-sm text-gray-600 opacity-75">Factures</p>
                    </div>
                    <span class="material-icons text-gray-400">receipt</span>
                </div>
                <div class="flex items-center text-xs text-green-600">
                    <span class="material-icons text-sm">trending_up</span>
                    <span>+12% vs mois dernier</span>
                </div>
            </div>
            
            <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow">
                <div class="flex items-start justify-between mb-3">
                    <div>
                        <p class="text-2xl font-semibold text-gray-900">8</p>
                        <p class="text-sm text-gray-600 opacity-75">Fournisseurs</p>
                    </div>
                    <span class="material-icons text-gray-400">business</span>
                </div>
                <div class="flex items-center text-xs text-gray-500">
                    <span class="material-icons text-sm">remove</span>
                    <span>Stable</span>
                </div>
            </div>
            
            <div class="bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-shadow">
                <div class="flex items-start justify-between mb-3">
                    <div>
                        <p class="text-2xl font-semibold text-gray-900">3</p>
                        <p class="text-sm text-gray-600 opacity-75">Avoirs</p>
                    </div>
                    <span class="material-icons text-gray-400">assignment_return</span>
                </div>
                <div class="flex items-center text-xs text-red-600">
                    <span class="material-icons text-sm">trending_down</span>
                    <span>-25% vs mois dernier</span>
                </div>
            </div>
            
            <div class="bg-white rounded-xl border border-gray-200 border-b-2 border-b-gray-300 p-6 hover:shadow-lg transition-shadow">
                <div class="flex items-start justify-between mb-3">
                    <div>
                        <p class="text-2xl font-semibold text-gray-900">382 421,45 <span class="text-sm font-normal text-gray-600">DA</span></p>
                        <p class="text-sm text-gray-600 opacity-60">Net à payer</p>
                    </div>
                    <span class="material-icons text-gray-400">account_balance_wallet</span>
                </div>
                <div class="flex items-center text-xs text-orange-600">
                    <span class="material-icons text-sm">warning</span>
                    <span>5 échéances ce mois</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Logique d'interaction pour les filtres
        document.addEventListener('DOMContentLoaded', function() {
            const periodQuickSelect = document.getElementById('periodQuickSelect');
            const monthSelect = document.getElementById('monthSelect');
            const yearSelect = document.getElementById('yearSelect');
            const statusSelect = document.getElementById('statusSelect');
            const resetButton = document.getElementById('resetFilters');
            const activeFiltersContainer = document.getElementById('activeFilters');
            
            // Gestion de la sélection rapide de période
            periodQuickSelect.addEventListener('change', function() {
                const value = this.value;
                const currentDate = new Date();
                const currentMonth = String(currentDate.getMonth() + 1).padStart(2, '0');
                const currentYear = currentDate.getFullYear();
                
                if (value === 'current') {
                    monthSelect.value = currentMonth;
                    yearSelect.value = currentYear;
                } else if (value === 'last') {
                    const lastMonth = currentDate.getMonth() === 0 ? 12 : currentDate.getMonth();
                    const lastMonthStr = String(lastMonth).padStart(2, '0');
                    const lastYear = lastMonth === 12 ? currentYear - 1 : currentYear;
                    monthSelect.value = lastMonthStr;
                    yearSelect.value = lastYear;
                } else if (value === 'quarter') {
                    // Logique pour le trimestre en cours
                    const quarter = Math.floor(currentDate.getMonth() / 3) + 1;
                    // Simplifié: on sélectionne le mois actuel
                    monthSelect.value = currentMonth;
                    yearSelect.value = currentYear;
                } else if (value === 'year') {
                    monthSelect.value = '';
                    yearSelect.value = currentYear;
                }
                
                updateActiveFilters();
            });
            
            // Fonction pour mettre à jour les filtres actifs
            function updateActiveFilters() {
                const activeFilters = [];
                
                if (monthSelect.value) {
                    const monthName = monthSelect.options[monthSelect.selectedIndex].text;
                    activeFilters.push({ type: 'month', label: monthName });
                }
                
                if (yearSelect.value) {
                    activeFilters.push({ type: 'year', label: yearSelect.value });
                }
                
                if (statusSelect.value) {
                    const statusName = statusSelect.options[statusSelect.selectedIndex].text;
                    activeFilters.push({ type: 'status', label: statusName });
                }
                
                // Afficher/masquer le bouton réinitialiser
                if (activeFilters.length > 0) {
                    resetButton.classList.remove('hidden');
                    activeFiltersContainer.classList.remove('hidden');
                    
                    // Afficher les tags de filtres
                    const tagsContainer = activeFiltersContainer.querySelector('.flex.gap-2');
                    tagsContainer.innerHTML = activeFilters.map(filter => `
                        <span class="inline-flex items-center gap-1 px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium">
                            ${filter.label}
                            <button class="hover:text-blue-900" onclick="removeFilter('${filter.type}')">
                                <span class="material-icons text-sm">close</span>
                            </button>
                        </span>
                    `).join('');
                } else {
                    resetButton.classList.add('hidden');
                    activeFiltersContainer.classList.add('hidden');
                }
            }
            
            // Fonction pour supprimer un filtre individuel
            window.removeFilter = function(type) {
                if (type === 'month') monthSelect.value = '';
                if (type === 'year') yearSelect.value = '';
                if (type === 'status') statusSelect.value = '';
                updateActiveFilters();
            };
            
            // Écouteurs d'événements pour les changements
            [monthSelect, yearSelect, statusSelect].forEach(select => {
                select.addEventListener('change', updateActiveFilters);
            });
            
            // Bouton réinitialiser
            resetButton.addEventListener('click', function() {
                monthSelect.value = '';
                yearSelect.value = '';
                statusSelect.value = '';
                periodQuickSelect.value = 'current';
                updateActiveFilters();
            });
            
            // Initialisation
            updateActiveFilters();
        });
    </script>
</body>
</html>
